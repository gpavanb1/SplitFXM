<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Finite-Volume Schemes - splitfxm</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../assets/docs.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Finite-Volume Schemes";
        var mkdocs_page_input_path = "flux.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> splitfxm
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../start/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../benchmark/">Benchmark</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../pricing/">Pricing</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../api/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model/">Model</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../domain/">Domain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ic/">Initial Conditions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../bc/">Boundary Conditions</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Finite-Volume Schemes</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#solving-equations-in-characteristic-space">Solving Equations in Characteristic Space</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#step-1-eigenvalue-decomposition">Step 1: Eigenvalue Decomposition</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-2-transformation-to-characteristic-variables">Step 2: Transformation to Characteristic Variables</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-3-scheme-application-upwind-fluxes-in-characteristic-space">Step 3: Scheme Application - Upwind Fluxes in Characteristic Space</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#step-4-transformation-back-to-conservative-variables">Step 4: Transformation Back to Conservative Variables</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.flux">flux</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.flux.fluxes">fluxes</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.flux.diffusion_fluxes">diffusion_fluxes</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Finite-Difference Schemes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../derivatives/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../generate/">Scheme Generation</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../visualize/">Visualization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Tutorials</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../tutorials/advection_diffusion/">Advection-Diffusion</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../tutorials/sod_shock/">Sod Shock Tube</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../tutorials/conservative_sod_shock/">Conservative Sod Shock Tube</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../refine/">Adaptive Mesh Refinement</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Internals</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../internals/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../cell/">Cell</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../boundary/">Boundary</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../system/">System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../simulation/">Simulation</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">splitfxm</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Code Documentation</li>
      <li class="breadcrumb-item active">Finite-Volume Schemes</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="finite-volume-schemes">Finite-Volume Schemes</h1>
<p>This section contains details related to the implementation of finite-volume schemes. Note that the flux-related methods are implemented using Cython.</p>
<h2 id="solving-equations-in-characteristic-space">Solving Equations in Characteristic Space</h2>
<p>To solve hyperbolic systems of equations, we use an upwind scheme in characteristic space. The process begins by computing the Jacobian matrix <script type="math/tex"> \mathbf{A} = \frac{\partial \mathbf{F}}{\partial \mathbf{U}} </script>, where <script type="math/tex"> \mathbf{F} </script> is the flux function and <script type="math/tex"> \mathbf{U} </script> represents the conservative variables. The Jacobian <script type="math/tex"> \mathbf{A} </script> is evaluated at the central state <script type="math/tex"> \mathbf{U}_c </script>.</p>
<h3 id="step-1-eigenvalue-decomposition">Step 1: Eigenvalue Decomposition</h3>
<p>Next, the Jacobian matrix <script type="math/tex"> \mathbf{A} </script> is decomposed into its eigenvalues and eigenvectors:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{A} = \mathbf{R} \mathbf{\Lambda} \mathbf{R}^{-1}
</script>
</p>
<p>where <script type="math/tex"> \mathbf{\Lambda} </script> is the diagonal matrix of eigenvalues <script type="math/tex"> \lambda_i </script>, and <script type="math/tex"> \mathbf{R} </script> is the matrix of right eigenvectors.</p>
<h3 id="step-2-transformation-to-characteristic-variables">Step 2: Transformation to Characteristic Variables</h3>
<p>The conservative variables <script type="math/tex"> \mathbf{U}_l </script> (left state), <script type="math/tex"> \mathbf{U}_c </script> (central state), and <script type="math/tex"> \mathbf{U}_r </script> (right state) are transformed into characteristic variables using the inverse of the eigenvector matrix:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{W}_l = \mathbf{R}^{-1} \mathbf{U}_l, \quad \mathbf{W}_c = \mathbf{R}^{-1} \mathbf{U}_c, \quad \mathbf{W}_r = \mathbf{R}^{-1} \mathbf{U}_r
</script>
</p>
<p>where <script type="math/tex"> \mathbf{W} </script> represents the characteristic variables.</p>
<h3 id="step-3-scheme-application-upwind-fluxes-in-characteristic-space">Step 3: Scheme Application - Upwind Fluxes in Characteristic Space</h3>
<p>Once the characteristic variables are computed, the fluxes are computed using any specified scheme. For the sake of disucssion, we will use the upwind scheme.</p>
<p>For each characteristic, the direction of the wave is determined by the sign of the corresponding eigenvalue <script type="math/tex"> \lambda_i </script>:</p>
<ul>
<li>If <script type="math/tex"> \lambda_i > 0 </script>, the wave moves to the right, and the flux at the west (left) side is determined using the left state, while the flux at the east (right) side is determined using the central state. This corresponds to the 'upwind' direction.</li>
<li>If <script type="math/tex"> \lambda_i < 0 </script>, the wave moves to the left, and the flux at the west side is determined using the central state, while the flux at the east side is determined using the right state. As the wave moves to the left in this case, the upwind direction is to the right.</li>
</ul>
<p>The characteristic fluxes are computed as:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{F}_w^\text{char} = \mathbf{F}(\mathbf{W}_l) \quad \text{if} \quad \lambda_i > 0, \quad \mathbf{F}_w^\text{char} = \mathbf{F}(\mathbf{W}_c) \quad \text{if} \quad \lambda_i < 0
</script>
<script type="math/tex; mode=display">
\mathbf{F}_e^\text{char} = \mathbf{F}(\mathbf{W}_c) \quad \text{if} \quad \lambda_i > 0, \quad \mathbf{F}_e^\text{char} = \mathbf{F}(\mathbf{W}_r) \quad \text{if} \quad \lambda_i < 0
</script>
</p>
<h3 id="step-4-transformation-back-to-conservative-variables">Step 4: Transformation Back to Conservative Variables</h3>
<p>After computing the fluxes in characteristic space, they are transformed back to the original conservative variable space using the eigenvector matrix <script type="math/tex"> \mathbf{R} </script>:</p>
<p>
<script type="math/tex; mode=display">
\mathbf{F}_w = \mathbf{R} \mathbf{F}_w^\text{char}, \quad \mathbf{F}_e = \mathbf{R} \mathbf{F}_e^\text{char}
</script>
</p>
<p>Thus, the west (left) and east (right) fluxes <script type="math/tex"> \mathbf{F}_w </script> and <script type="math/tex"> \mathbf{F}_e </script> are obtained in the original space.</p>
<p>This method allows the fluxes to be accurately computed by considering wave propagation direction, ensuring stability and correctness in solving hyperbolic systems.</p>


<div class="doc doc-object doc-module">



<a id="splitfxm.flux"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="splitfxm.flux.fluxes" class="doc doc-heading">
            <code class="highlight language-python">fluxes(F, cell_sub, scheme, dFdU=None, limiter=None)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-method descriptor"><code>method descriptor</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the fluxes for a given stencil and numerical scheme with limiters.</p>
<p>This function calculates the west and east fluxes for a given stencil
of cells, using the specified finite volume scheme. Optionally, a slope 
limiter can be applied to reduce non-physical oscillations in the fluxes.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>F</code></b>
                  (<code>function</code>)
              –
              <div class="doc-md-description">
                <p>The flux function, which defines the relationship between the values
of the conserved quantities and their fluxes.</p>
              </div>
            </li>
            <li>
              <b><code>cell_sub</code></b>
                  (<code>list of Cell</code>)
              –
              <div class="doc-md-description">
                <p>The stencil of cells over which the fluxes are calculated.</p>
              </div>
            </li>
            <li>
              <b><code>scheme</code></b>
                  (<code><span title="splitfxm.schemes.FVSchemes">FVSchemes</span></code>)
              –
              <div class="doc-md-description">
                <p>The finite volume scheme to use for flux calculations.
Available options include:</p>
<ul>
<li>LAX_FRIEDRICHS: Lax-Friedrichs scheme</li>
<li>UPWIND: Upwind differencing scheme</li>
<li>CENTRAL: Central differencing scheme</li>
</ul>
              </div>
            </li>
            <li>
              <b><code>dFdU</code></b>
                  (<code>function</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The Jacobian of the flux function, used for schemes that require
knowledge of wave propagation direction (e.g., upwind schemes).</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>tuple of numpy.ndarray</code>
              –
              <div class="doc-md-description">
                <p>The west (Fw) and east (Fe) fluxes computed using the given scheme.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="splitfxm.error.SFXM">SFXM</span></code>
              –
              <div class="doc-md-description">
                <p>If the stencil size is not appropriate for the chosen scheme.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>Each scheme has its own method of calculating fluxes:</p>
<ul>
<li>LAX_FRIEDRICHS: Uses a central average with a diffusive term.</li>
<li>UPWIND: Chooses fluxes based on the direction of the flow.</li>
<li>CENTRAL: Takes a simple average of fluxes at the cell interfaces.</li>
</ul>
</details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="splitfxm.flux.diffusion_fluxes" class="doc doc-heading">
            <code class="highlight language-python">diffusion_fluxes(D, cell_sub, scheme)</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-method descriptor"><code>method descriptor</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Calculate the diffusion fluxes of a given stencil.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>D</code></b>
                  (<code>function</code>)
              –
              <div class="doc-md-description">
                <p>The diffusion function.</p>
              </div>
            </li>
            <li>
              <b><code>cell_sub</code></b>
                  (<code>list of Cell</code>)
              –
              <div class="doc-md-description">
                <p>The stencil.</p>
              </div>
            </li>
            <li>
              <b><code>scheme</code></b>
              –
              <div class="doc-md-description">
                <p>The finite-volume scheme to use. Defaults to central scheme for now.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>tuple of numpy.ndarray</code>
              –
              <div class="doc-md-description">
                <p>The west and east diffusion fluxes.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../bc/" class="btn btn-neutral float-left" title="Boundary Conditions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../derivatives/" class="btn btn-neutral float-right" title="Overview">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../bc/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../derivatives/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Advection-Diffusion - splitfxm</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../../assets/docs.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Advection-Diffusion";
        var mkdocs_page_input_path = "tutorials/advection_diffusion.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> splitfxm
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../start/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../benchmark/">Benchmark</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../pricing/">Pricing</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../api/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../model/">Model</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../domain/">Domain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../ic/">Initial Conditions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../bc/">Boundary Conditions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../flux/">Finite-Volume Schemes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Finite-Difference Schemes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../derivatives/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../generate/">Scheme Generation</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../visualize/">Visualization</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Tutorials</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Advection-Diffusion</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#problem-setup">Problem Setup</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#simulation-setup">Simulation Setup</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#evolve-the-system">Evolve the System</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#visualize-the-results">Visualize the Results</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../sod_shock/">Sod Shock Tube</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../refine/">Adaptive Mesh Refinement</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Internals</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../internals/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cell/">Cell</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../boundary/">Boundary</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../system/">System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../simulation/">Simulation</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">splitfxm</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Code Documentation</li>
          <li class="breadcrumb-item">Tutorials</li>
      <li class="breadcrumb-item active">Advection-Diffusion</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="advection-diffusion">Advection-Diffusion</h1>
<p>This tutorial will walk you through the process of setting up an advection-diffusion problem using <code>splitfxm</code>. This is provided by default in the <code>splitfxm.models</code> module.</p>
<h2 id="problem-setup">Problem Setup</h2>
<p>First, we need to import the necessary modules and create a domain for the problem.</p>
<pre><code class="language-python">from splitfxm.domain import Domain
from splitfxm.simulation import Simulation
from splitfxm.models.advection_diffusion import AdvectionDiffusion
from splitfxm.schemes import default_scheme
from splitfxm.visualize import draw
</code></pre>
<p>Next, we need to define the method we are going to use. This can be either <code>FDM</code> or <code>FVM</code>.</p>
<p>Then, the domain can be created using the <code>Domain.from_size</code> method. The first argument is the number of cells in the x-direction, the second argument is the number of ghost cells on the left and right sides, and the third argument is the number of ghost cells on the bottom and top sides.</p>
<pre><code class="language-python"># Define the problem
method = 'FDM'
m = AdvectionDiffusion(c=0.2, nu=0.001, method=method)

# nx, nb_left, nb_right, variables
d = Domain.from_size(100, 1, 1, [&quot;u&quot;, &quot;v&quot;, &quot;w&quot;])
</code></pre>
<p>Once this is done, we can define the initial conditions and boundary conditions.</p>
<pre><code class="language-python"># Initial conditions
ics = {&quot;u&quot;: &quot;gaussian&quot;, &quot;v&quot;: &quot;rarefaction&quot;, &quot;w&quot;: &quot;tophat&quot;}

# Boundary conditions
bcs = {
    &quot;u&quot;: {
        &quot;left&quot;: &quot;periodic&quot;,
        &quot;right&quot;: &quot;periodic&quot;
    },
    &quot;v&quot;: {
        &quot;left&quot;: {&quot;dirichlet&quot;: 3},
        &quot;right&quot;: {&quot;dirichlet&quot;: 4}
    },
    &quot;w&quot;: {
        &quot;left&quot;: {&quot;dirichlet&quot;: 2},
        &quot;right&quot;: &quot;periodic&quot;
    }
}
</code></pre>
<h2 id="simulation-setup">Simulation Setup</h2>
<p>Now, we need to create a simulation object.</p>
<pre><code class="language-python">s = Simulation(d, m, ics, bcs, default_scheme(method))
</code></pre>
<h2 id="evolve-the-system">Evolve the System</h2>
<p>We can now evolve the system in time using the <code>evolve</code> method.</p>
<pre><code class="language-python">s.evolve(t_diff=0.1)
</code></pre>
<h2 id="visualize-the-results">Visualize the Results</h2>
<p>Finally, we can visualize the results using the <code>draw</code> function.</p>
<pre><code class="language-python">draw(d, &quot;label&quot;)
</code></pre>
<p>The results should look like this:</p>
<p><img alt="img" src="../../images/advection_diffusion.jpg" /></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../visualize/" class="btn btn-neutral float-left" title="Visualization"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../sod_shock/" class="btn btn-neutral float-right" title="Sod Shock Tube">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../visualize/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../sod_shock/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>

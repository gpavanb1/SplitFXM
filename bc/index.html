<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Boundary Conditions - splitfxm</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../assets/docs.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Boundary Conditions";
        var mkdocs_page_input_path = "bc.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> splitfxm
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../start/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../benchmark/">Benchmark</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Code Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../api/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../model/">Model</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../domain/">Domain</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ic/">Initial Conditions</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Boundary Conditions</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.bc">bc</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.bc.apply_BC">apply_BC</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.bc.extend_band">extend_band</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#splitfxm.bc.get_periodic_bcs">get_periodic_bcs</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../flux/">Finite Volume Schemes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../derivatives/">Finite Difference Schemes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../visualize/">Visualization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../refine/">Adaptive Mesh Refinement</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Internals</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../internals/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../cell/">Cell</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../boundary/">Boundary</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../system/">System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../simulation/">Simulation</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">splitfxm</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Code Documentation</li>
      <li class="breadcrumb-item active">Boundary Conditions</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="boundary-conditions">Boundary Conditions</h1>
<p>One of the key advantages of using this solver is that boundary conditions can be defined using a simple dictionary on either side of the domain.</p>
<p>The sparse Jacobian is automatically generated according to the boundary condition specified.</p>


<div class="doc doc-object doc-module">



<a id="splitfxm.bc"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="splitfxm.bc.apply_BC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_BC</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">bc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;periodic&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="s1">&#39;periodic&#39;</span><span class="p">},</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Apply boundary conditions to the given domain.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>d</code></b>
                  (<code><a class="autorefs autorefs-internal" title="splitfxm.domain.Domain" href="../domain/#splitfxm.domain.Domain">Domain</a></code>)
              –
              <div class="doc-md-description">
                <p>The domain to apply the boundary conditions to.</p>
              </div>
            </li>
            <li>
              <b><code>v</code></b>
                  (<code>str</code>)
              –
              <div class="doc-md-description">
                <p>The name of the variable to apply the boundary conditions to.</p>
              </div>
            </li>
            <li>
              <b><code>bc</code></b>
                  (<code>str</code>, default:
                      <code>{&#39;left&#39;: &#39;periodic&#39;, &#39;right&#39;: &#39;periodic&#39;}</code>
)
              –
              <div class="doc-md-description">
                <p>The type of boundary condition to apply. Acceptable values are "periodic" and "outflow". Default is "periodic".</p>
              </div>
            </li>
            <li>
              <b><code>xmin</code></b>
                  (<code>float</code>, default:
                      <code>0.0</code>
)
              –
              <div class="doc-md-description">
                <p>The minimum x-value of the domain. Default is 0.0.</p>
              </div>
            </li>
            <li>
              <b><code>xmax</code></b>
                  (<code>float</code>, default:
                      <code>1.0</code>
)
              –
              <div class="doc-md-description">
                <p>The maximum x-value of the domain. Default is 1.0.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Raises:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>NotImplementedError</code>
              –
              <div class="doc-md-description">
                <p>If an unsupported boundary condition is specified.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>splitfxm/bc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply_BC</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">Domain</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">bc</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;left&quot;</span><span class="p">:</span> <span class="s2">&quot;periodic&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span> <span class="s2">&quot;periodic&quot;</span><span class="p">},</span> <span class="n">xmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply boundary conditions to the given domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : Domain</span>
<span class="sd">        The domain to apply the boundary conditions to.</span>
<span class="sd">    v : str</span>
<span class="sd">        The name of the variable to apply the boundary conditions to.</span>
<span class="sd">    bc : str, optional</span>
<span class="sd">        The type of boundary condition to apply. Acceptable values are &quot;periodic&quot; and &quot;outflow&quot;. Default is &quot;periodic&quot;.</span>
<span class="sd">    xmin : float, optional</span>
<span class="sd">        The minimum x-value of the domain. Default is 0.0.</span>
<span class="sd">    xmax : float, optional</span>
<span class="sd">        The maximum x-value of the domain. Default is 1.0.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    NotImplementedError</span>
<span class="sd">        If an unsupported boundary condition is specified.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get cells</span>
    <span class="n">cells</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">cells</span><span class="p">()</span>

    <span class="c1"># Find index of component</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">component_index</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># Common values used in all types</span>
    <span class="n">ilo</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ilo</span><span class="p">()</span>
    <span class="n">ihi</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ihi</span><span class="p">()</span>

    <span class="n">lb</span><span class="p">,</span> <span class="n">rb</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">boundaries</span><span class="p">()</span>

    <span class="c1"># Check only required directions specified</span>
    <span class="n">bc_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">bc</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">bc_keys</span> <span class="o">!=</span> <span class="p">[</span><span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">LEFT</span><span class="p">],</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]]:</span>
        <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Incorrect boundary directions specified&quot;</span><span class="p">)</span>

    <span class="c1"># Iterate over left and right BCs</span>
    <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">bc_keys</span><span class="p">:</span>
        <span class="n">bc_type</span> <span class="o">=</span> <span class="n">bc</span><span class="p">[</span><span class="nb">dir</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">bc_type</span> <span class="o">==</span> <span class="s2">&quot;periodic&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">LEFT</span><span class="p">]:</span>
                <span class="c1"># left boundary</span>
                <span class="c1"># Ghost cells are (right to left) the rightmost elements (same order)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lb</span><span class="p">):</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

            <span class="k">elif</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
                <span class="c1"># right boundary</span>
                <span class="c1"># Ghost cells are (left to right) the leftmost elements (same order)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb</span><span class="p">):</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ilo</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">xmin</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">cells</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">ilo</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Incorrect boundary direction encountered&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">bc_type</span> <span class="o">==</span> <span class="s2">&quot;outflow&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">LEFT</span><span class="p">]:</span>
                <span class="c1"># left boundary</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lb</span><span class="p">):</span>
                    <span class="c1"># The shift mirrors the interior on the same side</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ilo</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">xmin</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span>
                    <span class="c1"># Value same as leftmost interior</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">cells</span><span class="p">[</span><span class="n">ilo</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

            <span class="k">elif</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
                <span class="c1"># right boundary</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb</span><span class="p">):</span>
                    <span class="c1"># The shift mirrors the interior on the same side</span>
                    <span class="n">shift</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                    <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span>
                    <span class="c1"># Value same as extrapolated from interior</span>
                    <span class="n">dy</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                    <span class="n">dx</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                    <span class="n">delta_x</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>

                    <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                        <span class="n">idx</span><span class="p">,</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dy</span><span class="o">/</span><span class="n">dx</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta_x</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Incorrect boundary direction encountered&quot;</span><span class="p">)</span>

        <span class="c1"># Dictionary-based boundary conditions</span>
        <span class="c1"># Dirichlet and Neumann BCs require additional values also</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bc_type</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">bc_type</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">bc_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bc_type</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">bc_type</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bc_type</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">bc_type</span> <span class="o">==</span> <span class="s2">&quot;neumann&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">LEFT</span><span class="p">]:</span>
                    <span class="c1"># left boundary</span>
                    <span class="n">neumann_value</span> <span class="o">=</span> <span class="n">bc_data</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lb</span><span class="p">):</span>
                        <span class="c1"># The shift mirrors the interior on the same side</span>
                        <span class="n">shift</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ilo</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">xmin</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span>

                        <span class="c1"># Cell width to the left</span>
                        <span class="n">dx</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">ilo</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ilo</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                            <span class="n">idx</span><span class="p">,</span> <span class="n">cells</span><span class="p">[</span><span class="n">ilo</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">-</span> <span class="n">neumann_value</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>

                <span class="k">elif</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
                    <span class="c1"># right boundary</span>
                    <span class="n">neumann_value</span> <span class="o">=</span> <span class="n">bc_data</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb</span><span class="p">):</span>
                        <span class="c1"># The shift mirrors the interior on the same side</span>
                        <span class="n">shift</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span>

                        <span class="c1"># Cell width to the right</span>
                        <span class="n">dx</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span>
                            <span class="n">idx</span><span class="p">,</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">+</span> <span class="n">neumann_value</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Incorrect boundary direction encountered&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">bc_type</span> <span class="o">==</span> <span class="s2">&quot;dirichlet&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">LEFT</span><span class="p">]:</span>
                    <span class="c1"># left boundary</span>
                    <span class="n">dirichlet_value</span> <span class="o">=</span> <span class="n">bc_data</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lb</span><span class="p">):</span>
                        <span class="c1"># The shift mirrors the interior on the same side</span>
                        <span class="n">shift</span> <span class="o">=</span> <span class="n">cells</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">ilo</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">-</span> <span class="n">xmin</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmin</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span>

                        <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">dirichlet_value</span><span class="p">)</span>

                <span class="k">elif</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
                    <span class="c1"># right boundary</span>
                    <span class="n">dirichlet_value</span> <span class="o">=</span> <span class="n">bc_data</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rb</span><span class="p">):</span>
                        <span class="c1"># The shift mirrors the interior on the same side</span>
                        <span class="n">shift</span> <span class="o">=</span> <span class="n">xmax</span> <span class="o">-</span> <span class="n">cells</span><span class="p">[</span><span class="n">ihi</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                        <span class="n">b</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">xmax</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span>

                        <span class="n">b</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">dirichlet_value</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Incorrect boundary direction encountered&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span>
                    <span class="s2">&quot;Incorrect data specified for dictionary-type boundaries&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Boundary type not implemented&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="splitfxm.bc.extend_band" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extend_band</span><span class="p">(</span><span class="n">band</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Extends a list of band indices to include points affected by periodic boundary conditions.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>band</code></b>
                  (<code>list</code>)
              –
              <div class="doc-md-description">
                <p>A list of current band indices to be extended.</p>
              </div>
            </li>
            <li>
              <b><code>dirs</code></b>
                  (<code>list</code>)
              –
              <div class="doc-md-description">
                <p>A list of boundary directions ('left', 'right') that determine how to extend the band 
based on periodic boundary conditions.</p>
              </div>
            </li>
            <li>
              <b><code>i</code></b>
                  (<code>int</code>)
              –
              <div class="doc-md-description">
                <p>The current point index within the domain where the band is being extended.</p>
              </div>
            </li>
            <li>
              <b><code>d</code></b>
                  (<code><a class="autorefs autorefs-internal" title="splitfxm.domain.Domain" href="../domain/#splitfxm.domain.Domain">Domain</a></code>)
              –
              <div class="doc-md-description">
                <p>An instance of the Domain class used to obtain boundary parameters such as <code>nb</code>, <code>ilo</code>, and <code>ihi</code></p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>list</code>
              –
              <div class="doc-md-description">
                <p>A new list containing the union of the original band and additional indices 
affected by periodic boundary conditions.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>This function works only for symmetric schemes. It handles overflow points for 
periodic boundaries by adding indices from the left or right domain as needed.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>splitfxm/bc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extend_band</span><span class="p">(</span><span class="n">band</span><span class="p">,</span> <span class="n">dirs</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Domain</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extends a list of band indices to include points affected by periodic boundary conditions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    band : list</span>
<span class="sd">        A list of current band indices to be extended.</span>
<span class="sd">    dirs : list</span>
<span class="sd">        A list of boundary directions (&#39;left&#39;, &#39;right&#39;) that determine how to extend the band </span>
<span class="sd">        based on periodic boundary conditions.</span>
<span class="sd">    i : int</span>
<span class="sd">        The current point index within the domain where the band is being extended.</span>
<span class="sd">    d : Domain</span>
<span class="sd">        An instance of the Domain class used to obtain boundary parameters such as `nb`, `ilo`, and `ihi`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        A new list containing the union of the original band and additional indices </span>
<span class="sd">        affected by periodic boundary conditions.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function works only for symmetric schemes. It handles overflow points for </span>
<span class="sd">    periodic boundaries by adding indices from the left or right domain as needed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Works only for symmetric schemes</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">nb</span><span class="p">()</span>

    <span class="n">ilo</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ilo</span><span class="p">()</span>
    <span class="n">ihi</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">ihi</span><span class="p">()</span>

    <span class="c1"># Iterate over left and right BCs</span>
    <span class="n">addl_points</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
        <span class="c1"># If right is periodic, check how much overflow there is</span>
        <span class="c1"># and add the left domain points to the band</span>
        <span class="k">if</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]:</span>
            <span class="n">overflow</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nb</span> <span class="o">-</span> <span class="p">(</span><span class="n">ihi</span> <span class="o">-</span> <span class="n">i</span><span class="p">))</span>
            <span class="n">addl_points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ilo</span><span class="p">,</span> <span class="n">ilo</span> <span class="o">+</span> <span class="n">overflow</span><span class="p">)))</span>
        <span class="c1"># If left is periodic, check how much overflow there is</span>
        <span class="c1"># and add the right domain points to the band</span>
        <span class="k">elif</span> <span class="nb">dir</span> <span class="o">==</span> <span class="n">btype_map</span><span class="p">[</span><span class="n">btype</span><span class="o">.</span><span class="n">LEFT</span><span class="p">]:</span>
            <span class="n">overflow</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nb</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">ilo</span><span class="p">))</span>
            <span class="n">addl_points</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ihi</span> <span class="o">-</span> <span class="n">overflow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ihi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SFXM</span><span class="p">(</span><span class="s2">&quot;Incorrect boundary direction encountered&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">band</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">addl_points</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="splitfxm.bc.get_periodic_bcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_periodic_bcs</span><span class="p">(</span><span class="n">bc_dict</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>Extracts periodic boundary conditions from a boundary condition dictionary.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>bc_dict</code></b>
                  (<code>dict</code>)
              –
              <div class="doc-md-description">
                <p>A dictionary where keys are component names and values are dictionaries of boundary conditions.</p>
              </div>
            </li>
            <li>
              <b><code>d</code></b>
                  (<code><a class="autorefs autorefs-internal" title="splitfxm.domain.Domain" href="../domain/#splitfxm.domain.Domain">Domain</a></code>)
              –
              <div class="doc-md-description">
                <p>An instance of the Domain class used to get the component index.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>dict</code>
              –
              <div class="doc-md-description">
                <p>A dictionary where keys are component indices and values are lists of boundary sides 
('left', 'right') that have periodic boundary conditions. Only components with periodic 
conditions are included in the output dictionary.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>splitfxm/bc.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_periodic_bcs</span><span class="p">(</span><span class="n">bc_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Domain</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts periodic boundary conditions from a boundary condition dictionary.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bc_dict : dict</span>
<span class="sd">        A dictionary where keys are component names and values are dictionaries of boundary conditions. </span>
<span class="sd">    d : Domain</span>
<span class="sd">        An instance of the Domain class used to get the component index.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        A dictionary where keys are component indices and values are lists of boundary sides </span>
<span class="sd">        (&#39;left&#39;, &#39;right&#39;) that have periodic boundary conditions. Only components with periodic </span>
<span class="sd">        conditions are included in the output dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">periodic_bcs</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">component</span><span class="p">,</span> <span class="n">bcs</span> <span class="ow">in</span> <span class="n">bc_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">component_index</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="n">sides</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">side</span><span class="p">,</span> <span class="n">bc_type</span> <span class="ow">in</span> <span class="n">bcs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">bc_type</span> <span class="o">==</span> <span class="s2">&quot;periodic&quot;</span><span class="p">:</span>
                <span class="n">sides</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">side</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sides</span><span class="p">:</span>
            <span class="n">periodic_bcs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">sides</span>

    <span class="k">return</span> <span class="n">periodic_bcs</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../ic/" class="btn btn-neutral float-left" title="Initial Conditions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../flux/" class="btn btn-neutral float-right" title="Finite Volume Schemes">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../ic/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../flux/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
